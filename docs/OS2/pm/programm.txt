/* 
 $Id: programm.txt,v 1.4 2003/07/17 20:21:38 evgen2 Exp $ 
*/

Фундаментальные понятия
-----------------------
клиент - отдельная программа. клиентов может быть несколько на нескольких компьютерах.
        Клиент - программа, котороя в наст.время имеет application type Window
      
сервер - сервер, обслуживающий клиентов. сервер отоборажает картинку десктопа
         на одном или нескольких устройствах. сервер передает сообщения от
         десктопа клиентам и между клиентами

номер клиента, выдаваемый сервером после соединения с клиентом

HAB - handle ancor block - индекс нитки, который выдает и хранит сервер.
      При выдаче клиенту индекса сервер проверяет наличие в списке клиента 
      и thread ordinal. 
      Индекс есть индекс элемента массива структуры _FreePM_HABserverinf
      Смотри также клиентскую структуру _FreePM_HABinf

HWND - handle окна. индекс окна, выдаваемый сервером клиенту.  
       Индекс есть индекс элемента массива структуры struct WND

DC   - дивайс контекст. хз что это такое у ибиемеров.
       индекс массива структур F_DC. Структура содержит номер дивайса,
       хендл окна. ?еще чего-нить.

HPS  - Handle Presentation Space. индекс массива структур F_PS, которая
       содержит DC, текущий цвет, текущий тип линии, текущую начальную точку,
       ? нечто, описывающее геометрию видимой области окна ?. 

сообщения
       могут передаваться между окнами. если сообщение должно быть передано
       между окнами одного клиента, то оно не выходит за пределы клиента
Очередь сообщений
       есть на сервере и на клиенте

===========================================================================
Как все это работает.
Сервер раздает ihab'ы и hwnd - индексы ниток и окон.
Окна получают сообщения.
Сообщения получаются либо из очередей, привязанных к ihab, либо напрямую,
есле они send из той же нитки, либо ненапрямую, но без помещения вочередь,
если они send из другой нитки процесса. Ненапрямую - значит оно вызывает процедуру 
окна внутри WinGetMsg.
Если сообщение посылается другому процессу, оно посылается через сервер.
Если send - то ждется, если post, то пихается в очередь процесса, опять-таки
внутрях WinGetMsg

Сервер
по запросу клиента F_CMD_GET_IHAB выдает свободный ihab, и clientId

Как писать программы:
Берется исходник для PM. Исправляются инклуды с os2.h на F_OS2.hpp
и дефайны с INCL_DOS, INCL_WIN на F_INCL_DOS, F_INCL_WIN
добавляется #include "PM_FPM.h" и добавляем в проект клиентские библиотеки
FreePM.

Обратная совместимость.
Чтоб программа для FreePM могла работать под PM и чтоб не менять все вызовы
F_xxx на WinXXX или GpiXXX добавляем в проект файл \FreePM\lib\PMcompat\PM_api.cpp